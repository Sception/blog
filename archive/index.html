<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前言 | JamesZ Blog</title>
    <meta name="description" content="This is JamesZ Blog.">
    <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog/assets/css/0.styles.c519d922.css" as="style"><link rel="preload" href="/blog/assets/js/app.15621967.js" as="script"><link rel="preload" href="/blog/assets/js/5.a6233305.js" as="script"><link rel="prefetch" href="/blog/assets/js/2.737193df.js"><link rel="prefetch" href="/blog/assets/js/3.587faffa.js"><link rel="prefetch" href="/blog/assets/js/4.90be2a1a.js"><link rel="prefetch" href="/blog/assets/js/6.173136fa.js"><link rel="prefetch" href="/blog/assets/js/7.5742dcd3.js"><link rel="prefetch" href="/blog/assets/js/8.7c6f31d3.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.c519d922.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">JamesZ Blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/archive/" class="nav-link router-link-exact-active router-link-active">博客</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/archive/" class="nav-link router-link-exact-active router-link-active">博客</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>123</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/archive/" class="active sidebar-link">前言</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/archive/#一、下载ueditor相关静态文件存放位置" class="sidebar-link">一、下载Ueditor相关静态文件存放位置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/archive/#vue-cli2" class="sidebar-link">vue-cli2</a></li><li class="sidebar-sub-header"><a href="/blog/archive/#vue-cli3" class="sidebar-link">vue-cli3</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/archive/#二、引入vue-ueditor-wrap后的相关配置" class="sidebar-link">二、引入vue-ueditor-wrap后的相关配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/archive/#vue-cli2-2" class="sidebar-link">vue-cli2</a></li><li class="sidebar-sub-header"><a href="/blog/archive/#vue-cli3-2" class="sidebar-link">vue-cli3</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/archive/#三、修改富文本内容长度计算方式" class="sidebar-link">三、修改富文本内容长度计算方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/archive/#修改ueditor-all-js的方式" class="sidebar-link">修改`ueditor.all.js`的方式</a></li><li class="sidebar-sub-header"><a href="/blog/archive/#修改ueditor-all-min-js的方式" class="sidebar-link">修改`ueditor.all.min.js`的方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/archive/#四、其他问题" class="sidebar-link">四、其他问题</a></li><li class="sidebar-sub-header"><a href="/blog/archive/#最后" class="sidebar-link">最后</a></li></ul></li><li><a href="/blog/archive/one.html" class="sidebar-link">Hello VuePress One!</a></li><li><a href="/blog/archive/two.html" class="sidebar-link">Hello VuePress Two!</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h1> <p>使用<strong>vue-cli3.0+element-ui+webpack</strong>做项目时,遇到了一个需求:文章管理中添加富文本编辑器(暂未添加上传图片功能),在百度上查看到好几个富文本编辑器,最终选择了百度的<code>Ueditor</code>,基本能满足所有需求。经过多番采坑之后，已实现相关功能,特此做一个记录。</p> <h2 id="一、下载ueditor相关静态文件存放位置"><a href="#一、下载ueditor相关静态文件存放位置" aria-hidden="true" class="header-anchor">#</a> 一、下载Ueditor相关静态文件存放位置</h2> <p>首先去<a href="https://ueditor.baidu.com/website/download.html" target="_blank" rel="noopener noreferrer">Ueditor官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>下载相关资源(本文下载的1.4.3.3Jsp版本):
<img src="https://user-gold-cdn.xitu.io/2019/2/22/169148d49735aad7?w=946&h=814&f=png&s=108714" alt="Ueditor相关资源文件">
这里主要针对<code>vue-cli2</code>与<code>vue-cli3</code>进行区分。</p> <h3 id="vue-cli2"><a href="#vue-cli2" aria-hidden="true" class="header-anchor">#</a> vue-cli2</h3> <p><code>vue-cli2</code> 版本中会生成一个<code>static</code>文件夹,用于放置静态资源,将下载的压缩包解压后放入<code>static</code>文件夹中:
<img src="https://user-gold-cdn.xitu.io/2019/2/23/169184c1fa33eaef?w=305&h=277&f=png&s=10614" alt></p> <h3 id="vue-cli3"><a href="#vue-cli3" aria-hidden="true" class="header-anchor">#</a> vue-cli3</h3> <p><code>vue-cli3</code> 在项目初始化时会生成一个<code>public</code>文件夹(<a href="https://cli.vuejs.org/zh/guide/html-and-static-assets.html#public-%E6%96%87%E4%BB%B6%E5%A4%B9" target="_blank" rel="noopener noreferrer">public文件夹使用场景<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,<code>public</code>文件夹中的文件不会被webpack打包编译,只是简单的复制到打包后的<code>dist</code>文件夹中)。将下载的压缩包解压并重命名<code>UE</code>放入<code>public</code>文件夹中:
<img src="https://user-gold-cdn.xitu.io/2019/2/22/169148481b418ca0?w=294&h=229&f=png&s=9211" alt="解压后的Ueditor存放目录"></p> <h2 id="二、引入vue-ueditor-wrap后的相关配置"><a href="#二、引入vue-ueditor-wrap后的相关配置" aria-hidden="true" class="header-anchor">#</a> 二、引入vue-ueditor-wrap后的相关配置</h2> <p>先安装<code>vue-ueditor-wrap</code>,然后在相关组件中引入<code>vue-ueditor-wrap</code></p> <div class="language- extra-class"><pre class="language-text"><code>npm i vue-ueditor-wrap -D
</code></pre></div><p>在相关组件中注册并引入:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/169183d39a72710c?w=1419&h=32&f=png&s=6301" alt> <img src="https://user-gold-cdn.xitu.io/2019/2/23/169184cba23004b2?w=1289&h=108&f=png&s=8185" alt> <img src="https://user-gold-cdn.xitu.io/2019/2/23/169183cac1407a0a?w=960&h=80&f=png&s=9167" alt></p> <p>重点主要在<code>myconfig</code>配置参数上(详细配置参数见<code>UE/ueditor.config.js</code>)，在<code>vue-cli2</code>与<code>vue-cli3</code>上略显不同。</p> <h3 id="vue-cli2-2"><a href="#vue-cli2-2" aria-hidden="true" class="header-anchor">#</a> vue-cli2</h3> <p>项目使用<code>vue-cli2</code>进行搭建并且将<code>UE</code>文件夹复制到了<code>static</code>文件夹中(<strong>如第一点所示</strong>),<code>UEDITOR_HOME_URL</code>配置为:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/1691852ad661d52e?w=997&h=349&f=png&s=31888" alt>
同时修改配置文件<code>ueditor.config.js</code>中的UEDITOR_HOME_URL为<code>'/UE/'</code></p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/1691861c73727d13?w=997&h=245&f=png&s=26092" alt></p> <h3 id="vue-cli3-2"><a href="#vue-cli3-2" aria-hidden="true" class="header-anchor">#</a> vue-cli3</h3> <p>使用<code>vue-cli3</code>的<code>UEDITOR_HOME_URL</code>配置为:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/169185162e277577?w=1238&h=351&f=png&s=46137" alt>
同时修改配置文件<code>ueditor.config.js</code>中的<code>UEDITOR_HOME_URL</code>为<code>'/static/UE/'</code></p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/1691862a4f709b2b?w=1280&h=249&f=png&s=28719" alt>
上述步骤无误的话,最终显示结果应为:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/1691865088eea474?w=1623&h=579&f=png&s=65174" alt></p> <h2 id="三、修改富文本内容长度计算方式"><a href="#三、修改富文本内容长度计算方式" aria-hidden="true" class="header-anchor">#</a> 三、修改富文本内容长度计算方式</h2> <p>该Ueditor中的内容长度(在这里仅以<code>vue</code>双向绑定为例)都是按照1个字符长度进行计算的,如插入一个表情显示长度为1:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/169186d60a3addd8?w=1501&h=487&f=png&s=57698" alt>
实际上应该为带标签的字节长度,这里需要修改<code>ueditor.all.js</code>或者<code>ueditor.all.min.js</code>的源码。</p> <h3 id="修改ueditor-all-js的方式"><a href="#修改ueditor-all-js的方式" aria-hidden="true" class="header-anchor">#</a> 修改<code>ueditor.all.js</code>的方式</h3> <p>在<code>ueditor.all.js</code>文件中全局查找<code>getContentLength</code>:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/1691870a0e6da0c2?w=1323&h=418&f=png&s=59350" alt>
将高亮部分注释掉,然后将该文件压缩混淆后替换<code>ueditor.all.min.js</code>文件即可</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/1691872074424710?w=1229&h=337&f=png&s=39397" alt></p> <h3 id="修改ueditor-all-min-js的方式"><a href="#修改ueditor-all-min-js的方式" aria-hidden="true" class="header-anchor">#</a> 修改<code>ueditor.all.min.js</code>的方式</h3> <p>该方式比较简单粗暴,直接在<code>ueditor.all.min.js</code>中全局搜索<code>getContentLength</code>并删除高亮部分:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/169187539533fb24?w=1820&h=253&f=png&s=135872" alt>
修改成功后的效果为:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/1691876b29955d17?w=1600&h=500&f=png&s=60803" alt></p> <h2 id="四、其他问题"><a href="#四、其他问题" aria-hidden="true" class="header-anchor">#</a> 四、其他问题</h2> <p>如在配置中出现下图类似问题：</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/23/169187f2b649c4e7?w=1901&h=28&f=png&s=4597" alt>
请仔细检查配置参数<code>UEDITOR_HOME_URL</code>路径是否正确。仔细检查！仔细检查！仔细检查！重要的事情说三遍~</p> <h2 id="最后"><a href="#最后" aria-hidden="true" class="header-anchor">#</a> 最后</h2> <p>希望本文能帮助到有需要的你~
<img src="https://user-gold-cdn.xitu.io/2019/2/23/169187a723e697eb?w=300&h=300&f=jpeg&s=6294" alt>
相关参考资料:
<a href="https://github.com/HaoChuan9421/vue-ueditor-wrap" target="_blank" rel="noopener noreferrer">vue-ueditor-wrap<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/archive/one.html">
          Hello VuePress One!
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/blog/assets/js/app.15621967.js" defer></script><script src="/blog/assets/js/5.a6233305.js" defer></script>
  </body>
</html>
